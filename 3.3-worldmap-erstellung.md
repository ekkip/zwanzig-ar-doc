---
title: WorldMap-Erstellung
parent: Portal Editor
grand_parent: Übersicht
nav_order: 3
---

# WorldMap-Erstellung

## Einleitung

### Augmented Reality

Die mit dem __Portal Editor__ zu erstellenden WordMaps sind Teil der __spieltechnischen Zusatzinhalte__ für die App __Object by Object__ (siehe [Dokumentation](2.4-zusatzinhalte.html)). WorldMaps bilden die technische Grundlage für [Persistent AR](2.4-zusatzinhalte.html#persistent-ar-und-worldmaps).

### Hardware-Voraussetzungen
Grundsätzlich ist der Scan mit jedem ARKit-fähigen iOS-Gerät möglich, die Scan-Qualität ist aber von der Qualität der Kamera und des Prozessors abhängig. Um die bestmögliche Scan-Qualität zu erreichen, wird ein LIDAR-fähiges Gerät (z.B. iPad Pro 2020) empfohlen.


## Scan-Vorbereitung

### Auswahl des Spielortes

Da das Spiel im öffentlichen Raum stattfindet, ist die Auswahl des richtigen Spielortes von besonderer Bedeutung.
Dazu gibt es einige Kern-Kriterien:

- Sicherheit der User*in muss bestmöglich gewährleistet sein:
  - Abseits von Verkehr und Straßen
  - Keine Auffahrten

- Längeres Verweilen sowie der Umgang mit dem Telefon müssen geduldet sein.
  - Botschaften, Polizeipräsidien oder anderen bewachte Gebäude sind ein No-Go

- Ausreichend Platz zum Spielen

- Öffentlicher Zugang zu jeder Tageszeit

- Verändert sich nicht in absehbarer Zeit:
  - Bei direkter Sonneneinstrahlung nicht von kontrastreicher Schattenbildung betroffen
  - Nicht von Vandalismus betroffen

- Mit geeignetem [Einstiegspunkt](3.3-worldmap-erstellung.html#einstiegspunkt-definieren) ausgestattet


### Auswahl des Zeitpunktes
Sobald die Entscheidung für einen Spielort gefallen ist, müssen Tageszeit und Wetterbedingungen beachtet werden, um den besten Zeitpunkt für einen Scan abzupassen.  Die Kern-Kriterien sind:

- Ausreichendes Tageslicht
  - Die Scan-Qualität ist direkt vom Grad der Ausleuchtung abhängig

- Trockener Untergrund
  - Nässe färbt den Untergrund dunkler, was dazu führen kann, dass die WorldMap bei trockenem Wetter nicht wieder erkannt wird

- Keine kontrastreichen Schattenbildungen auf den zu scannenden Oberflächen
  - Schatten verändern sich mit dem Lauf der Sonne und damit ändert sich auch die Wahrscheinlichkeit der Wiedererkennung


### Auswahl des Einstiegsareals

Das Einstiegsareal ist der Bereich eines Ortes, der so markant ist, dass die WorldMap anhand dessen direkt erkannt wird.
[Hinweis-Bild](https://ekkip.github.io/zwanzig-ar-doc/2.2-cms-struktur.html#hint-image-contentful-media-asset) und [Hinweis-Text](https://ekkip.github.io/zwanzig-ar-doc/2.2-cms-struktur.html#hint-text-text) beziehen sich auf diesen.

Je markanter dieses Areal aufgrund seiner Oberflächenbeschaffenheit oder Topologie ist, desto besser funktioniert es.


#### Bewertung der Qualität eines Einstiegsareals

Was gut funktioniert:
* Markante Topologie
* Kontrastreiche Oberflächenbeschaffenheit

Was nicht gut funktioniert:
* Kontrastreiche Oberflächen, die vergänglich sind (z.B. Graffiti)
* Kontrastarme Oberflächen


## Scan

### 1. WorldMap erstellen

Zuerst muss eine WorldMap als Ausgangspunkt für die AR-Session selektiert werden.

Hierzu gibt es die folgenden Möglichkeiten:
* Erstellung einer neuen WorldMap [3.5](3.2-app-aufbau#portal-details)
* Nutzung einer bereits erstellten lokalen WorldMap [3.4](3.2-app-aufbau#portal-details)
* Erstellung und Nutzung einer lokalen Kopie einer heruntergeladenen oder lokalen WorldMap [4.5](3.2-app-aufbau#worldmap-details)



### 2. AR-Session starten

Nach der Auswahl der WorldMap wird die AR-Session dann über den Button `Create New Session`/`Edit Session` [4.4](3.2-app-aufbau#worldmap-details) gestartet.

`Set Alignment` sollte auf `Both` gestellt sein [4.2](3.2-app-aufbau#worldmap-details), damit horizontale und vertikale Flächen erkannt werden.

Die `Debugging Options` [4.1](3.2-app-aufbau#worldmap-details) geben während der Session wertvolles Feedback bezüglich des aktuellen Scan-Fortschritts, indem die gefundenen Flächen visualisiert werden. Gerade für Neulinge im Bereich der WorldMap-Erstellung ist es empfehlenswert diese einzuschalten.



### 3. Einstiegsareal scannen

Die AR-Session sollte stets mit einem Scan des Einstiegsareals begonnen werden. Bei einer neuen und noch leeren WorldMap wird so sichergestellt, dass dieses Areal auch als Einstieg gespeichert wird.

Beim Scannen ist es wichtig sich zu bewegen. Das zu scannende Areal sollte aus möglichst vielen Richtungen gescannt werden, damit eine möglichst robuste WorldMap entsteht. Dazu ist es zwingend notwendig während des Scannens verschiedene Positionen im Raum einzunehmen.

Um eine Idee davon zu bekommen welche Oberflächen bereits erkannt wurden, sollten die `Debugging Options` [4.1](3.2-app-aufbau#worldmap-details) für die Session aktiviert sein. Die dunklen Rechtecke repräsentieren die bereits hinzugefügten Flächen in der Szene, auf denen dann die Objekte positioniert werden können.

Der Scan-Vorgang sollte so lange fortgeführt werden bis alle Oberflächen, auf denen Objekte positioniert werden sollen, erfasst wurde.



### 4. Objekte positionieren

Sind alle notwendigen Oberflächen erfasst, können die Objekte und das Portal den eigenen Wünschen entsprechend positioniert werden. Alle hinzugefügten Oberflächen können als Stehflächen für diese genutzt werden.

Die Position und Rotation aller Objekte wird mittels der [hier](3.2-app-aufbau.html#positionierung-der-objekte) beschriebenen Interaktionen angepasst.

Für die verschiedenen Objekt-Typen gibt es die folgenden Empfehlungen zur Positionierung:


`Portal`
Empfohlene Orientierung: Horizontal
Bemerkungen:
* Das Portal muss vom Einstiegsareal aus für die User/in direkt ersichtlich sein. Daher darf es nicht zu nah und auch nicht zu weit entfernt von diesem positioniert sein. Ideal ist eine Entfernung von 3-4m.

`Self-Contained (3D-Modell)`
Empfohlene Orientierung: Abhängig vom Modell
Bemerkungen:
* Die Orientierung eines Self-Contained 3D-Models sollte der natürlichen Orientierung des Objektes entsprechen

`Paper (Papier)`
Empfohlene Orientierung: Abhängig vom Inhalt
Bemerkungen:
* Die Orientierung sollte dem Inhalt entsprechen. Ein historisches Poster sollte an einer Wand positioniert werden, ein historischer Vertrag hingegen macht vielleicht am meisten Sinn auf Tisch.

`Picture Frame (Bilderrahmen)`
Empfohlene Orientierung: Vertikal

`Camera on Tripod (Foto-Kamera)`
Empfohlene Orientierung: Horizontal
Bemerkungen:
* Idealerweise können der Inhalt des Fotos und die Ausrichtung der Kamera im Stadtraum in Verbindung miteinander gebracht werde (z.B. wird auf dem Foto ein historisches Gebäude abgebildet, sollte die Kamera, falls möglich, auch auf historischen Standplatz dieses Gebäudes ausgerichtet sein)

`Gramophone (Gramofon)`
Empfohlene Orientierung: Horizontal

`Film (Video)`
Empfohlene Orientierung: Vertikal

`Slide Projector (Dia-Projektor ohne Leinwand)`
Empfohlene Orientierung: Horizontal
Bemerkungen:
* Die Projektionsfläche sollte an einer physischen Wand platziert sein

`Slide Projector with Screen (Dia-Projektor mit Leinwand)`
Empfohlene Orientierung: Horizontal

`Fragmente`
Bei den Fragmenten gibt es grundsätzlich diee Unterscheidung zwischen Primär-Fragment (F.1) und normalen Fragmenten (F.2). Das Primär-Fragment ist jenes Fragment, an dem alle weiteren Fragmente zusammen gesetzt werden. Das Primär-Objekt lässt sich daran erkennen, dass es im Gegensatz zu den anderen Teilen nicht maskiert dargestellt wird (siehe Bild). Das Primär-Objekt sollte aus UX-Gründen an der Wand positioniert werden. Die anderen Teile sollen auf dem Boden positioniert werden.

![Fragmentiertes Poster](/img/pe_fragment.png)



### 5. Speichern

Sind alle Objekte an ihrem gewünschten Platz, muss die WorldMap gespeichert werden. Ist die Auto-Save-Funktionalität nicht aktiviert, muss das Speichern nur beim Schließen der Session bestätigt werden.



### 6. Robustheit des Einstiegsareals verbessern

Um eine WorldMap flexibler und für die User/in im Spiel einfacher zu erkennen zu machen, macht es Sinn die Robustheit des Einstiegsareals durch weitere Scan-Iterationen zu verbessern.

Dazu wird eine bereits erstellte WorldMap erneut über `Edit Session` [4.4](3.2-app-aufbau#worldmap-details) geöffnet, aber der Einstiegspunkt im Vergleich zum vorherigen Scan leicht verändert. So wird ein anderer Bereich des Einstiegsareals gescannt oder es aus einer anderen Perspektive gescannt. Danach bewegt man sich zum in der vorherigen Session definierten Einstiegspunkt bis die WorldMap erkannt wird. Der Einstiegsbereich wurde nun erfolgreich vergrößert.

Je nach Bedarf können so durch zusätzliche Iterationen weitere Einstiegspunkte hinzugefügt werden bzw. das Einstiegsareal nach Belieben vergrößert werden.

Ab einer bestimmten Größe der WorldMap werden vorherige Einstiegspunkte aber wieder überschrieben. Eine genaue Regel dazu gibt es nicht. Die Funktionsweise der WorldMaps muss daher kontinuierlich getestet werden.



### 7. Testen

Die Funktionsweise der WorldMap lässt sich über `Play Session` [4.3](3.2-app-aufbau#worldmap-details) testen. Dabei ist besonders darauf zu achten wie schnell und problemlos das Laden der WorldMaps beim Scannen des Einstiegsareals funktioniert.

Es ist sinnvoll im iterativen Prozess regelmäßig Kopien lokaler WorldMaps zu generieren, damit die Robustheit mit jeder Iteration miteinander verglichen werden kann.



### 8. Exportieren

Die erstellte WorldMap-Datei kann über die Export-Funktion des Portal Editors [5.3](3.2-app-aufbau.html#worldmap-details) exportiert werden. Aus dem Sharing-Dialog heraus kann diese per Mail oder Airdrop an einen Rechner geschickt werden, wo diese dann auf Contentful hochgeladen und dem entsprechenden Portal hinzugefügt werden kann.



### 9. Hinweis-Bild und Hinweis-Text erstellen

Nach dem Erstellen der WorldMap müssen noch ein Hinweis-Bild und ein Hinweis-Text erstellt werden, welche das gespeicherte Einstiegsareal möglichst genau repräsentieren. Denn diese sind für die User/in der einzige Weg den Eingang zum Portal finden zu können.



---

## Fehlerbehebung

### Performance-Optimierung

Beim Spielen der Session werden detaillierte Informationen zur Performance ausgegeben [5.3](3.2-benutzung.html#ar-session)

- Anzahl der Objekte reduzieren
- Dateigröße von genutzten 3D-Objekten, Fotos und Videos reduzieren
